<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="uk-UA" xml:lang="uk-UA"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.269">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2022-09-01">

<title>Т’юторіал з R для психологів - Імпорт даних в RStudio</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./part2.html" rel="next">
<link href="./intro.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">Імпорт даних в RStudio</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Т’юторіал з R для психологів</a> 
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Передмова</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link">Вступ</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./part1.html" class="sidebar-item-text sidebar-link active">Імпорт даних в RStudio</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./part2.html" class="sidebar-item-text sidebar-link">Об’єм вибірки</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./part3.html" class="sidebar-item-text sidebar-link">Якість даних</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./part4.html" class="sidebar-item-text sidebar-link">Величина ефекту</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./part5.html" class="sidebar-item-text sidebar-link">Перетворення змінних</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./part6.html" class="sidebar-item-text sidebar-link">Описові статистики</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./part7.html" class="sidebar-item-text sidebar-link">Порівняння середніх</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./part8.html" class="sidebar-item-text sidebar-link">Кореляційний аналіз</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./summary.html" class="sidebar-item-text sidebar-link">Висновки</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">Література</a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">на цій сторінці</h2>
   
  <ul>
  <li><a href="#етапи-дослідження" id="toc-етапи-дослідження" class="nav-link active" data-scroll-target="#етапи-дослідження">Етапи дослідження</a></li>
  <li><a href="#інсталяція-r" id="toc-інсталяція-r" class="nav-link" data-scroll-target="#інсталяція-r">Інсталяція R</a></li>
  <li><a href="#підготовка-даних" id="toc-підготовка-даних" class="nav-link" data-scroll-target="#підготовка-даних">Підготовка даних</a></li>
  <li><a href="#приклад-даних" id="toc-приклад-даних" class="nav-link" data-scroll-target="#приклад-даних">Приклад даних</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block">Імпорт даних в RStudio</h1>
</div>



<div class="quarto-title-meta">

    
    <div>
    <div class="quarto-title-meta-heading">Дата публікації</div>
    <div class="quarto-title-meta-contents">
      <p class="date">September 1, 2022</p>
    </div>
  </div>
  
    <div>
    <div class="quarto-title-meta-heading">Modified</div>
    <div class="quarto-title-meta-contents">
      <p class="date-modified">November 17, 2022</p>
    </div>
  </div>
    
  </div>
  

</header>

<p>Необхідність власне у програмуванні на початкових етапах використання R не виникає, користувачу достатньо розуміти, як підготувати і імпортувати дані, викликати невелику кількість функцій для виконання перетворень змінних, статистичного аналізу і побудови діаграм, виводити табличні і графічні результати аналізу для їх наступного включення у текст статті або звіту. Пізніше на цій основі можна розвивати важливу для сучасних дослідників компетенцію програмування: створення власних функцій або розробки нових методів статистичного аналізу.</p>
<section id="етапи-дослідження" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="етапи-дослідження">Етапи дослідження</h2>
<p>Зазвичай емпіричне психологічне дослідження розгортається у такій послідовності: 1) Планування дослідження: визначення його дизайну, величини очікуваних ефектів і потрібного об’єму вибірки, підбір або створення якісних інструментів вимірювання психологічних конструктів; 2) Збирання і введення даних у комп’ютер; 3) Імпорт таблиці даних в середовище R; 4) Попередня обробка даних: використання статистичних процедур для перевірки якості даних (наприклад, пошук незвичних спостережень, які можуть негативно позначитися на результатах — так званих «викидів»), обчислення показників надійності для психологічних шкал; 5) Обчислення індексів (інтегральних показників, факторів), перекодування змінних, створення факторів (категоріальних змінних), категоризація неперервних ознак, агрегація даних, зміна структури таблиці даних (перевертання, витягнення по горизонталі чи вертикалі); 6) Відбір спостережень для аналізу (наприклад, виключення пропущених значень чи зосередження на цільовій сукупності досліджуваних); 7) Виклик статистичних процедур для опису даних, перевірки гіпотез і побудови статистичних моделей; 8) Створення фінального звіту за результатами. R за допомогою мови розмітки Markdown дозволяє генерувати такі звіти з таблицями, графіками і довільним текстом у форматі PDF, HTML і Word.</p>
</section>
<section id="інсталяція-r" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="інсталяція-r">Інсталяція R</h2>
<p>Перед початком роботи потрібно встановити R на комп’ютері з дистрибутивів в залежності від типу операційної системи (див. веб-сайт проекту https://cran.r-project.org/ або компанії Майкрософт https://mran.microsoft.com/). Набагато зручніше працювати з R у спеціальному середовищі розробника — RStudio (див. https://rstudio.com/). Проте для початківців найкращий варіант — скористатися хмарною версією R і RStudio, яку можна знайти за посиланням http://rstudio.cloud. Вхід до хмарної версії здійснюється після простої процедури реєстрації. Суттєвими перевагами цього способу є відсутність необхідності інсталювати і оновлювати програми на власному комп’ютері, постійний доступ до даних і скриптів аналізу через мережу Інтернет, а також можливість спільної роботи з викладачем чи іншими дослідниками.</p>
</section>
<section id="підготовка-даних" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="підготовка-даних">Підготовка даних</h2>
<p>Найбільш оптимальним форматом збереження даних для початківця є формат Microsoft Excel. Якщо цей табличний процесор не встановлений на вашому комп’ютері, можна скористатися безплатним сервісом Google Таблиці. Це особливо зручно, коли збирання даних здійснюється за допомогою сервісу опитувань Google Форми, оскільки відповіді респондентів відразу зберігаються у потрібному вигляді. Зібрані дані можна звантажити у форматі Microsoft Excel, або скористатися можливістю отримати доступ до них безпосередньо з R.</p>
</section>
<section id="приклад-даних" class="level2 unnumbered page-columns page-full">
<h2 class="unnumbered anchored" data-anchor-id="приклад-даних">Приклад даних</h2>
<p>Дані, на яких будуть демонструватися можливості R в цій статті, представляють собою результати опитування студентів НаУКМА, проведеного у 2019 році в рамках бакалаврської кваліфікаційної роботи Марією Жаб’юк за адаптованою версією шкали Perceived Stress Scale (Cohen et al., 1983).</p>
<p>Шкала PSS складається з 10 питань, мета яких – отримати інформацію про те, в якій мірі досліджувані сприймають різноманітні обставини свого життя як стресові.</p>
<pre><code>1. Були засмучені через те, що сталось несподівано?
2. Bідчували, що неспроможні контролювати важливі речі у вашому житті?
3. Відчували себе знервовано чи в стані стресу?
4. Відчували себе впевнено стосовно того, що здатні впоратись з власними проблемами?
5. Відчували, що події відбуваються так, як вам треба?
6. Були впевненими, що не можете впоратись з усім тим, що маєте зробити?
7. Відчували себе здатними контролювати те, що вас дратує?
8. Були впевненими, що ви все контролюєте?
9. Були злими через події, які ви не могли контролювати?
10. Здавалось, що труднощі накопичуються так швидко, що ви не можете їх подолати?</code></pre>
<p>Досліджувані обирали один з п’яти варіантів відповіді: ніколи (0 балів), майже ніколи (1 бал), іноді (2 бали), доволі часто (3 бали), дуже часто (4 бали).</p>
<p>Половина пунктів шкали має зворотний ключ (питання 4, 5, 7, 8) для контролю установки давати однакові відповіді.</p>
<div class="column-page-right">
<div id="fig-dataset" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/google sheets.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Рисунок&nbsp;1: Таблиця даних</figcaption><p></p>
</figure>
</div>
</div>
<p>Таблиця даних містить відповіді 462 досліджуваних (див. <a href="#fig-dataset">Рис.&nbsp;<span>1</span></a>). На додаток до ідентифікаційного номеру досліджуваного і десяти питань шкали PSS в ній представлені стать (gender), курс (year) і фінансовий стан сім’ї студента (fin_state).</p>
<p>Переглянути і завантажити ці дані в форматі Excel можна за посиланням <a href="https://osf.io/egs3d" class="uri">https://osf.io/egs3d</a> з сайту Open Science Framework (OSF).</p>
<p>На прикладі цієї таблиці легко пояснити основні моменти підготовки даних дослідження для наступного статистичного аналізу в R:</p>
<ol type="1">
<li><p>Перший рядок таблиці має містити імена змінних (їхні скорочені позначення). Правила вибору імен для змінних наступні: вони мають починатися з літери (краще латинського алфавіту) чи крапки, після яких можуть йти інші літери, цифри 0-9, крапка чи символ нижнього підкреслювання. Пробіл в іменах змінних є неприпустимим. Імена варто обирати так, щоб можна було легко зрозуміти, яка змінна аналізується. Зверніть увагу, що R розрізняє великі і маленькі літери в іменах об’єктів, тому змінні gender, Gender і GENDER будуть сприйматися як різні.</p></li>
<li><p>За бажанням розгорнуту інформацію про змінну, наприклад мітки змінних та мітки значень, можна розмістити у додатковому аркуші книги (на <a href="#fig-dataset">Рис.&nbsp;<span>1</span></a> це аркуш Variable View). Пои що більшість функцій R, на відміну від пакету IBM SPSS Statistics, не використовують текстові мітки змінних (variable label), проте це обмеження при необхідності можна легко обійти.</p></li>
<li><p>Перший стовпчик таблиці має містити унікальний код досліджуваного, за яким його можна ідентифікувати при здійсненні злиття, відбору, чистки даних чи внесенні додаткової інформації про учасників, що може з’явитися пізніше. Важливо зберігати анонімність досліджуваних, якщо дані будуть розповсюджуватися, тому ідентифікувати їх краще за все числами або спеціальними кодами.</p></li>
<li><p>Якщо значення певної змінної у досліджуваного з тих чи інших причин відсутнє, клітинку потрібно лишити пустою. При імпорті даних в R пусті клітинки отримають спеціальне значення NA («Not Available»), яке буде враховуватися при обчисленнях. Також відсутні значення можна закодувати рядком NA або будь-яким числом, яке буде вказуватися при імпорті даних як ознака пропуску. Познайомимося тепер з інтерфейсом програми RStudio (див. Рис. 2). Після входу у хмарну версію користувач потрапляє на сторінку з переліком своїх проектів. Для створення нового проекту треба клацнути кнопку New Project, після чого на екран завантажується застосунок RStudio. Він має рядок меню, панель інструментів і три віконця з вкладками. За замовчанням з лівого боку розташовано вікно консолі, в якому користувач вводить команди і отримує текстові результати виконання команд і повідомлення системи. Цей режим роботи не дуже зручний для початківця, тому варто в якості першого кроку відкрити додаткове вікно для введення тексту майбутнього скрипту (сценарію, програми) аналізу даних. Для цього оберіть в меню застосунку RStudio послідовність команд File – New File – R Script. На <a href="#fig-rstudio">Рис.&nbsp;<span>2</span></a> це вікно позначено кружечком з цифрою 1. Поки вміст цього вікна ви не зберегли у файлі, його назва буде Untitled 1.</p></li>
</ol>
<div class="column-page-right">
<div id="fig-rstudio" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/rstudio.cloud.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Рисунок&nbsp;2: Інтерфейс RStudio</figcaption><p></p>
</figure>
</div>
</div>
<p>У віконці 1 користувач вводить текст сценарію обробки своїх даних, запускає на виконання окремий рядок, блок рядків чи увесь сценарій, а результати виконання команд будуть з’являтися в інших віконцях. Так, у віконці №3 відображається луна виконаних команд і їхні текстові результати, у віконці №2 (вкладка Global Environment, Глобальне Середовище) з’являтимуться створені під час аналізу об’єкти (наприклад, таблиці з імпортованими чи проміжними даними).</p>
<p>Віконце №4 містить найбільшу кількість корисних для початківця вкладок. Тут відображаються файли у поточній папці (вкладка Files), побудовані графіки (вкладка Plots), встановлені пакети (вкладка Packages), довідкова інформація (вкладка Help), згенеровані функціями веб-сторінки (вкладка Viewer).</p>
<p>Для проведення аналізу у хмарній версії RStudio підготовлений файл даних у форматі Excel слід спершу завантажити у хмарне сховище. Для цього у віконці №4 на вкладці Files клацніть кнопку Upload («завантажити»), оберіть файл з даними (наприклад, файл pss.xlsx), який знаходиться на вашому комп’ютері і дайте підтвердження. Після успішного завантаження ім’я файлу з’явиться у переліку файлів вкладки Files.</p>
<p>Наступний крок – імпорт даних з файлу. Цей крок зазвичай здійснюється за допомогою виклику відповідної функції з потрібними аргументами, але для початківця простіше обрати в меню застосунку команду File – Import Dataset – From Excel. Якщо RStudio виведе діалогове вікно з питанням про оновлення необхідних для імпорту пакетів, дайте ствердну відповідь і зачекайте, поки RStudio виконує компіляцію і встановлення пакетів.</p>
<p>Діалогове вікно імпорту файлів Excel має декілька елементів керування. Перш за все знайдіть потрібний файл (в нашому випадку це pss.xlsx), клацнувши кнопку Browse. Попередній перегляд вмісту файлу буде виведене у таблиці Data Preview. В групі опцій імпорту елементи мають таке призначення: поле Name має містити ім’я об’єкту – таблиці даних, в яку після імпорту потрапить вміст файлу. У випадаючому списку Sheets можна обрати ім’я аркушу книги для читання (за замовчанням читатиметься перший аркуш). Оберіть аркуш з назвою «Data View».</p>
<p>Поле NA має містити код, яким ви позначили пропущені дані у файлі. Якщо ви скористалися моєю порадою і пропущені значення кодували за допомогою пустих клітинок в таблиці Excel, це поле можна лишити незаповненим. Нарешті, встановлений прапорець First Row as Names повідомляє процедурі імпорту, що імена майбутніх змінних таблиці даних слід брати з першого рядку файлу Excel. Зверніть увагу на те, що у віконці Code Preview знаходиться декілька рядків команд на мові R, які власне і здійснюють імпортування даних. На їхньому прикладі ви почнете знайомитися з мовою R. Скопіюйте їх у текст вашої першої програми аналізу даних. Я трохи змінив зовнішній вигляд команд для кращої читабельності і додав коментарі (пояснювальний текст, що йде після символу #)– див. Фрагмент коду 1:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Завантаження пакету для імпорту даних в форматі MS Excel</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Імпорт даних з файлу</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>pss <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">path =</span> <span class="st">"pss.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"Data View"</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Виведення вмісту об'єкту на екран</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>pss</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 462 × 14
      id    b1    b2    b3    b4    b5    b6    b7    b8    b9   b10 gender
   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;
 1     1     0     0     1     3     3     1     2     3     3     0      1
 2     2     2     1     4     2     1     1     2     0     3     2      2
 3     3     1     2     3     1     1     3     1     1     3     2      2
 4     4     1     2     2     3     3     3     1     1     4     2      2
 5     5     3     3     3     3     3     2     3     2     1     1      2
 6     6     0     1     4     3     4     0     3     3     0     3      1
 7     7     1     4     4     1     0     3     0     1     4     4      1
 8     8     2     1     2     3     2     1     2     2     2     1      1
 9     9     2     2     1     4     3     0     3     3     2     1      1
10    10     2     2     4     3     2     3     2     2     2     3      2
# … with 452 more rows, and 2 more variables: year &lt;dbl&gt;, fin_state &lt;dbl&gt;</code></pre>
</div>
</div>
<p>Розберемо цей фрагмент програми, з якого практично завжди починається аналіз даних. По-перше, слід запам’ятати, що дві представлені в ньому команди <em>library()</em> та <strong>read_excel()</strong> називаються функціями. Функції відіграють надзвичайно важливу роль в R, кожна з них має своє особливе призначення — імпорт чи перетворення даних, побудова діаграм, виконання статистичного аналізу і виведення результатів у потрібному вигляді здійснюється відповідними функціями. Для цього функціям при виклику передається інформація у вигляді аргументів – таблиць даних і змінних у них, а також вказівок на бажаний характер переробки вхідної інформації і виведення результатів (опцій).</p>
<p>Аргументи функції йдуть у послідовному порядку і можуть мати свої власні імена. Наприклад, функція read_excel() має аж дванадцять аргументів, які визначають безліч корисних аспектів її поведінки в різних обставинах (наприклад, назви і типи стовпчиків таблиці даних, кодування пропущених значень тощо):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">args</span>(read_excel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>function (path, sheet = NULL, range = NULL, col_names = TRUE, 
    col_types = NULL, na = "", trim_ws = TRUE, skip = 0, n_max = Inf, 
    guess_max = min(1000, n_max), progress = readxl_progress(), 
    .name_repair = "unique") 
NULL</code></pre>
</div>
</div>
<p>Ми використали лише два її найважливіших аргументи з іменами <strong>path</strong> (шлях і ім’я файлу Excel, з якого відбувається імпорт даних) і <strong>sheet</strong> (ім’я аркуша книги). Оскільки ці два аргументи йдуть першими, можна було б і не вказувати їхні імена при виклику функції, але обов’язкове іменування аргументів – корисна практика для початківців, оскільки дозволяє краще розуміти створений скрипт. Зауважте, що в цьому прикладі обом аргументам функції передаються рядкові значення, взяті у подвійні лапки. Знак = («дорівнює») відділяє ім’я аргументу і значення, яке йому передається, а один аргумент від іншого відділяється комою.</p>
<p>Деякі аргументи функції мають значення «за замовчанням», тобто, якщо користувач при виклику функції не вказує цей аргумент, його значення встановлюється автоматично. Наприклад, аргумент <strong>col_names</strong> має логічне значення за замовчанням <strong>TRUE</strong> (істина, тобто – «так, в файлі перший рядок містить імена стовпчиків»). Аргументи за замовчанням має сенс вказувати тільки тоді, коли ви хочете передати їм якесь інше значення.</p>
<p>Виклик функції може давати безпосередній і побічний результат. Функція, як кажуть програмісти, <em>повертає</em> безпосередній результат. В R це може бути вектор, що складається тільки з елементів одного й того ж типу – чисел, рядків тексту або логічних значень (так звані «атомарні вектори»). Функція також може повертати вектор, елементами якого є об’єкти різного типу – вектори, матриці, списки. Такі особливі вектори називаються <strong>списками</strong> (list). Ви звернули увагу, що елементами списку можуть бути інші списки? Списки дуже корисні для зберігання комплексної інформації і будуть зустрічатися нам весь час при аналізі даних в R – як структура для зберігання даних, аргумент функцій і результат, який функція повертає. Наприклад, функція read_excel() повертає особливий тип списку під назвою tibble, в якому R зберігає таблицю даних емпіричного дослідження.</p>
<p>До речі, не лякайтеся терміну «вектор», для вас зараз це має означати лише послідовність певних значень: чисел, рядків, об’єктів. Вектори в R відіграють різні ролі – це можуть бути змінні, які піддаватимуться аналізу, опції для функцій, або результати, які повертають функції. Найпростіший спосіб створити вектор чисел (чи рядків, логічних значень тощо) – скористатися особливою функцією <strong>c()</strong>. Їй в дужках передаються через кому аргументи, які функція зчеплює в один об’єкт-вектор. Наприклад, вираз c(1, 2, 3, 4, 5) створить вектор з п’яти цілих чисел від 1 до 5. Існує зручний скорочений спосіб створення таких послідовностей цілих чисел, який ви будете часто використовувати для того, щоб звернутися до послідовних стовпчиків таблиці даних. Запис 1:5, наприклад, згенерує таку саму послідовність з п’яти цілих чисел:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1 2 3 4 5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="sc">:</span><span class="dv">5</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1 2 3 4 5</code></pre>
</div>
</div>
<p>Результат, який повернула функція, треба пов’язати з ім’ям, щоб його можна було використовувати надалі в скрипті. Якщо цього не зробити, він просто виводиться на екран. Для зв’язування об’єкту-результату і обраного аналітиком імені в R є спеціальний оператор присвоєння, який складається з двох символів – знаку «менше» або «більше» та дефісу – і виглядає, як стрілка: <code>&lt;-</code> та <code>-&gt;</code>. У короткому фрагменті скрипту, який ми розбираємо, за допомогою оператора присвоєння імпортовані з Excel дані записуються в об’єкт на ім’я pss. Цей об’єкт після імпорту і зв’язування з іменем починає існувати у Глобальному Середовищі (на Рис. 2 ви можете побачити його у віконці №2). Тепер до об’єкта pss можна звертатися, передаючи його іншим корисним функціям.</p>
<p>Окрім безпосереднього результату, який функція повертає, вона може бути корисною своїми побічними ефектами. Наприклад, функція hist() в якості побічного результату будує спеціальний графік – гістограму – для переданого їй вектору даних.</p>
<p>Залишилося пояснити перший рядок фрагменту нашої програми. Що означає команда library(readxl)? Справа в тому, що функцій в R величезна кількість. Тому їх групують за призначенням у так звані «пакети» (packages). Частина пакетів є базовими і встановлюються при інсталяції R і RStudio. Необов’язкові пакети (а їх зараз нараховується десятки тисяч) потрібно спочатку встановити із спеціальних сховищ в Інтернеті («репозиторіїв») і підключити до сеансу роботи, щоб функції, які в них включені, стали доступними для виклику. Функція library() якраз і призначена для підключення пакету readxl до сеансу роботи. Як зрозуміло з назви пакету, він містить функції для читання файлів у форматі Microsoft Excel.</p>
<p>Для відтворення процедур аналізу даних, які розглядаються в цій статті, вам необхідно інсталювати з репозиторію такі пакети: readxl, psych, pwr, dplyr, car, jmv, MBESS, MOTE. Кожен з них, в свою чергу, може залежати від інших пакетів, які будуть встановлюватися автоматично. Найпростіший для початківця спосіб інсталяції пакета передбачає використання меню застосунку RStudio. Оберіть в ньому команду Tools – Install Packages і вкажіть назви пакетів у діалоговому вікні, що з’явиться на екрані. Після інсталяції назви нових пакетів будуть додані до списку у бібліотеці користувача (див. вкладку Packages віконця №4).</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./intro.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Вступ</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./part2.html" class="pagination-link">
        <span class="nav-page-text">Об’єм вибірки</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>